DATA SEGMENT
	PA EQU 288H
	PB EQU 289H
	PC EQU 28AH
	CTL55 EQU 28BH
	AD EQU 290H
	DA EQU 280H
	DAT DB ?
DATA ENDS

CODE SEGMENT
    ASSUME CS:CODE,DS:DATA
START:  MOV AX,DATA
	MOV DS,AX
	MOV CX,200H
	MOV DX,CTL55
	MOV AL,10011000B
	OUT DX,AL

	MOV DX,PC
L1:	IN AL,DX
	TEST AL,80H
	JNZ L1     ;OR JZ 判断脉冲来

	MOV DX,290H
	MOV AL,00H
	OUT DX,AL   ;驱动0809进行转换

L2:	MOV DX,PC
	IN AL,DX    
	TEST AL,80H
	JZ L2       ;转换结束

	MOV DX,290H
	IN AL,DX
	CMP AL,5AH	;和90进行比较
	JC NEXT2	;大于输出三角波，小于输出锯齿波

NEXT1:	MOV AL,00H

NEXT4:MOV DX,280H ;锯齿波
	OUT DX,AL
	CALL DELAY
	CMP AL,0F0H
	JZ NEXT5
	ADD AL,10H
	JMP NEXT4

NEXT5:	JMP   NEXT1
	MOV AH,4CH
	INT 21H

NEXT2:  MOV DX,280H
	OUT DX,AL
	CALL DELAY
	CMP AL,0F0H
	JZ NEXT3
	ADD AL,10H
	JMP NEXT2

NEXT3:  SUB AL,10H
	MOV DX,280H
	OUT DX,AL
	CALL DELAY
	CMP AL,00H
	JNZ  NEXT3
	JMP  NEXT2

	MOV AH,4CH
	INT 21H
DELAY PROC NEAR
	PUSH CX
	MOV CX,200H
NEXT6:	LOOP NEXT6
	MOV CX,200H
NEXT7:	LOOP NEXT7
	POP CX
	RET
DELAY ENDP
CODE ENDS
      END START