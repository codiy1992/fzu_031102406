
    
            #include<stdio.h>   
void main()   
{   
    int n,m,i,j,i2,j2,k,num[1000][100],l[100];   
    char b,r,p,q,x;   
    scanf("%d%d",&n,&m);   
    for(i=0;i<n;i++)   
    {   
        scanf("%d",&k);   
        l[i]=k;   
        for(j=0;j<k;j++)   
            scanf("%d",&num[i][j]);   
    }   
  
  
    for(i=0;i<m;i++)   
    {   
            getchar();   
        scanf("%c",&r);   
            getchar();   
        if(r=='Q')    
        {   
            scanf("%d",&p);   
            if(l[p-1]==0) printf("-1");   
            else  
            for(j=0;j<l[p-1];j++)   
                printf("%d ",num[p-1][j]);   
            printf("\n");   
  
        }   
           
        else  
            if(r=='U')   
        {   
        scanf("%d%d",&p,&q);   
  
for(i2=l[p-1],j2=0;j2<l[q-1];i2++,j2++)   
{   
num[p-1][i2]=num[q-1][j2];   
}   
l[p-1]+=l[q-1];   
l[q-1]=0;   
  
        }   
            else  
                if(r=='I')   
                {   
                    scanf("%d%d",&p,&x);   
                    for(i2=l[p-1];i2>0;i2--)   
                        num[p-1][i2]=num[p-1][i2-1];   
                    num[p-1][0]=x;   
                    l[p-1]++;   
                       
                }   
                else  
                    if(r=='D')   
                    {   
                        scanf("%d%d",&p,&x);   
  
  
                        for(i2=0;i2<l[p-1];i2++)   
                            if(num[p-1][i2]==x)   
                            {   
                             for(j2=i2;j2<l[p-1]-1;j2++)   
                             num[p-1][j2]=num[p-1][j2+1];   
                             l[p-1]--;   
                            }   
                       
                    }   
  
  
  
  
  
    }   
  
} 